% !TEX root = ../main.tex

\section{Introduction}
\label{sect:introduction}

The Ethereum blockchain project was launched in 2014 by announcing Ether (ETH) as its protocol-level cryptocurrency \cite{EthGit,EIP150}. Ethereum allows users to build and deploy decentralized applications (DApps), or smart contracts, that can accept and use ETH. Many DApps also issue their own custom tokens with a variety of intents, including tokens as: financial products, in-house currencies, voting rights for DApp governance, valuable assets, crypto-collectibles, \etc To encourage interoperability with other DApps and web apps (exchanges, wallets, \etc), the Ethereum community accepted a popular token standard (for non-fungible tokens) called \erc\footnote{\url{https://eips.ethereum.org/EIPS/eip-20}}. While numerous \erc extensions or replacements have been proposed, \erc remains prominent. Of the 2.5M\footnote{[2020-05-03] \url{https://reports.aleth.io}} smart contracts on the Ethereum network, 260K\footnote{[2020-05-03] \url{https://etherscan.io/tokens}} are tokens. 97.8\% of these tokens are \erc\cite{EtherScan}, demonstrating their widespread acceptance by the industry and Ethereum community.

The development of smart contracts has been proven to be error-prone, and as a result, smart contracts are often riddled with security vulnerabilities. An early study in 2016 found that 45\% of smart contracts at that time had vulnerabilities~\cite{MakSm}. In the ensuing years, the community began to concentrate on security, including the development of security auditing tools (typically using static analysis). \erc token security is particularly important given that many tokens have considerable market capitalization (\eg USDT, LINK and USDC each have over a billion dollars). 

As tokens can be held by commercial firms, in addition to individuals, and firms need audited financial statements in certain circumstances, the correctness of the contract issuing the tokens is now in the purview of professional auditors. One tool we examine, EY Smart Contract and Token Review \footnote{\url{https://review-tool.blockchain.ey.com/}}, is from a `big-four' auditing firm. 

\paragraph{Contributions.} Similar to any new technology, Ethereum has undergone numerous security attacks that have collectively caused more than US\$100M in financial losses~\cite{DAO1,PeckShield,PartiyMultiSig,MyEthWallet,ParityFirstHack,ParitySecondHack}. Although research has been done on smart contract vulnerabilities in the past~\cite{EthSecServ}, our focus is on \erc tokens only. Some vulnerabilities (such as multiple withdrawals) will be more apparent and serious in tokens contracts. Other attacks will not apply to \erc tokens, such as SWC-112 (Delegatecall to untrusted callee) and SWC-113 (DoS with Failed Call). We also consider the best practices for improving the efficiency of token contracts (\eg as \erc compliance, Emitting token transfer events, modifying token allowance). This motivates us to (i) comprehensively study all known vulnerabilities in \erc token contracts, systematizing them\footnote{Note to reviewers: we debated if our paper is an SoK or not but decided because of (ii), it is not a pure SoK. We are open to having it appear in either category.} into a set of \num distinct vulnerabilities and best practices, and review the completeness and precision of auditing tools in detecting these vulnerabilities to establish the reliability of an audit based on these tools. We (ii) use this research to provide a new secure implementation of the \erc interface, \sys, that is freely available and open source. Finally, (iii) we also examine the practicality of our work in the context of the top ten \erc tokens by market capitalization. While we focus on \erc, many \erc proposed replacements (\ie ERC-223~\cite{Ref20}, 667~\cite{Ref21}, 721~\cite{Ref22}, 777~\cite{Ref23}, 827~\cite{Ref24}, 1155~\cite{Ref25}, 1377~\cite{Ref26}) either fully subsume \erc functionality (\ie they extend the \erc interface) or they overlap considerably.