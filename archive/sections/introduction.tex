% !TEX root = ../main.tex

\section{Introduction}
\label{sect:introduction}

Ethereum blockchain \cite{EthGit,EIP150} allows users to build and deploy decentralized applications (DApps) that can accept and use ETH as its protocol-level cryptocurrency. Many DApps also issue their own custom tokens with a variety of intents, including tokens as: financial products, in-house currencies, voting rights for DApp governance, valuable assets, crypto-collectibles, \etc To encourage interoperability with other DApps and web apps (exchanges, wallets, \etc), the Ethereum community accepted a popular token standard (for non-fungible tokens) called \erc\cite{ERC20Std}. While numerous \erc extensions or replacements have been proposed, \erc remains prominent. Of the 2.5M\cite{Alethio} smart contracts on the Ethereum network, 260K are tokens \cite{TokenTracker}. 98\% of these tokens are \erc\cite{EtherScan}, demonstrating their widespread acceptance by the industry and Ethereum community.

The development of smart contracts has been proven to be error-prone, and as a result, smart contracts are often riddled with security vulnerabilities. An early study in 2016 found that 45\% of smart contracts at that time had vulnerabilities\cite{MakSm}. \erc token are subset of smart contracts and security is particularly important given that many tokens have considerable market capitalization (\eg USDT, LINK, CRO, LEO, DAI, \etc). As tokens can be held by commercial firms, in addition to individuals, and firms need audited financial statements in certain circumstances, the correctness of the contract issuing the tokens is now in the purview of professional auditors. One tool we examine, EY Smart Contract and Token Review\cite{EYTool}, is from a `big-four' auditing firm. 

%In the ensuing years, the community began to concentrate on security, including the development of security auditing tools (typically using static analysis).

\paragraph{Contributions.} Similar to any new technology, Ethereum has undergone numerous security attacks that have collectively caused more than US\$100M in financial losses\cite{DAO1,PeckShield,PartiyMultiSig,MyEthWallet,ParityFirstHack,ParitySecondHack}. Although research has been done on smart contract vulnerabilities in the past\cite{EthSecServ}, our focus is on \erc tokens only. Some vulnerabilities (such as multiple withdrawals) will be more serious in token contracts. This motivates us to (i) comprehensively study all known vulnerabilities in \erc token contracts, systematizing them into a set of \num distinct vulnerabilities and best practices, and review the completeness and precision of auditing tools in detecting these vulnerabilities to establish the reliability of an audit based on these tools. We (ii) use this research to provide a new secure implementation of the \erc interface, \sys, that is freely available and open source. Compared to other implementations from OpenZeppelin\cite{OpenZepplin} and ConsenSys\cite{ConsensysToken}, it is more secure and fully compatible with \erc specifications. Finally, (iii) we examine the practicality of our work in the context of the top ten \erc tokens by market capitalization.

%\footnote{Note to reviewers: we debated if our paper is an SoK or not, but we are open to having it appear in either category.}

% While we focus on \erc, many \erc proposed replacements (\ie ERC-223\cite{Ref20}, 667\cite{Ref21}, 721\cite{Ref22}, 777\cite{Ref23}, 827\cite{Ref24}, 1155\cite{Ref25}, 1377\cite{Ref26}) either fully subsume \erc functionality (\ie they extend the \erc interface) or they overlap considerably.

% Other attacks will not apply to \erc tokens (\eg Delegatecall to untrusted callee, DoS with Failed Call) and are out of the scope. We also consider the best practices for improving the efficiency of token contracts (\eg as \erc compliance, Emitting token transfer events, modifying token allowance). 